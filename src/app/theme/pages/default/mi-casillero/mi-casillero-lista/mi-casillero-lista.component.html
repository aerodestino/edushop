<div class="m-subheader">
    <div class="d-flex align-items-center">
        <div class="mr-auto">
            <h3 class="page-title">
                {{appService.title}}
            </h3>
        </div>
    </div>
</div>
<hr>
<div class="m-subheader" *ngIf="appService.user">
    <div class="d-flex align-items-center">
        <div class="profile-info col-12">
            <div class="row" >
            <div class="col-10">
                <h1 >
                    {{appService.user.nombre}} {{appService.user.apellido}}
                </h1>
            </div>
            <div class="col-2">
            <button (click)="onNoticias(noticiaModal)"
            [disabled]="appService.noticiasSinLeer == 0"
            class="btn btn-success text-right"
            style="background-color:#fa3030 ; border-color:#fa3030;top:15px">
               {{ appService.noticiasSinLeer }} Noticias
            </button>
            </div>
            </div>
            <div class="row">
                <div class="col-md-5 col-lg-5 col-sm-12">
                    <span style="font-size: 14px">
                        <i class="fa fa-briefcase"></i>
                        <strong>Dirección: </strong> {{appService.user.direccion}}
                    </span><br>
                    <span style="font-size: 14px" *ngIf="appService.user.ciudad">
                        <i class="fa fa-location-arrow"></i>
                        <strong>Ciudad: </strong> {{appService.user.ciudad.nombre}}
                    </span><br>
                    <span style="font-size: 14px" *ngIf="appService.user.provincia">
                        <i class="fa fa-location-arrow"></i>
                        <strong>Provincia: </strong> {{appService.user.provincia.nombre}}
                    </span><br>
                    <span style="font-size: 14px" *ngIf="appService.user.codigo_postal">
                        <i class="fa fa-location-arrow"></i>
                        <strong>Código Postal: </strong> {{appService.user.codigo_postal}}<br>
                    </span>
                    <span style="font-size: 14px" *ngIf="appService.user.telefono1">
                        <i class="fa fa-location-arrow"></i>
                        <strong>Teléfono: </strong> {{appService.user.telefono1}}<br>
                    </span>
                    <span style="font-size: 14px" *ngIf="appService.user.celular">
                        <i class="fa fa-location-arrow"></i>
                        <strong>Celular: </strong> {{appService.user.celular}}<br>
                    </span>
                </div>
                <div class="col-md-7 col-lg-7 col-sm-12">
                    <span style="font-size: 14px">
                        <strong>Casillero Internacional: </strong>
                    </span><br>
                    <span style="font-size: 14px">
                         {{appService.user.nombre}} {{appService.user.apellido}} / {{appService.user.interfaz.name}}
                    </span><br>
                    <span style="font-size: 14px">
                         {{appService.user.interfaz.direccion}} #{{appService.user.codigo}}
                    </span><br>
                    <span style="font-size: 14px">
                         {{appService.user.interfaz.region}}
                    </span><br>
                    <span style="font-size: 14px">
                         Telf: {{appService.user.interfaz.telefono}}
                    </span><br>
                </div>

            </div>
        </div>
    </div>
</div>
<div class="m-content">
    <div class="form-group m-form__group row align-items-center">
        <div class="col-md-3">
            <div class="m-input-icon m-input-icon--left">
                <input type="text" class="form-control m-input m-input--solid" placeholder="Buscar..."
                       [(ngModel)]="enBodegaFilters.q" name="search" *ngIf="enBodegaSeleccionadas"  (keyup.enter)="getEnBodega()">
                
                <input type="text" class="form-control m-input m-input--solid" placeholder="Buscar..."
                [(ngModel)]="embarcadosFilters.q" name="search" (keyup.enter)="getEmbarcados()" *ngIf="embarcadosSeleccionadas">
                <input type="text" class="form-control m-input m-input--solid" placeholder="Buscar..."
                [(ngModel)]="enTransitoFilters.q" name="search" (keyup.enter)="getEnTransito()" *ngIf="enTransitoSeleccionadas">
                <input type="text" class="form-control m-input m-input--solid" placeholder="Buscar..."
                [(ngModel)]="facturacionFilters.q" name="search" (keyup.enter)="getFacturacion()" *ngIf="facturacionSeleccionadas">
                <input type="text" class="form-control m-input m-input--solid" placeholder="Buscar..."
                [(ngModel)]="rutaNacionalFilters.q" name="search" (keyup.enter)="getRutaNacional()" *ngIf="rutaNacionalSeleccionadas">
                <input type="text" class="form-control m-input m-input--solid" placeholder="Buscar..."
                [(ngModel)]="entregadosFilters.q" name="search" (keyup.enter)="getEntregados()" *ngIf="entregadosSeleccionadas">
                <input type="text" class="form-control m-input m-input--solid" placeholder="Buscar..."
                [(ngModel)]="estatusFilters.q" name="search" (keyup.enter)="getEstatus()" *ngIf="estatusSeleccionadas">
              
                <span class="m-input-icon__icon m-input-icon__icon--left">
                    <span>
                        <i class="fa fa-search"></i>
                    </span>
                </span>
            </div>
        </div>
        <div class="form-group m-form__group col-md-1 col-lg-1 col-sm-1" style="text-align: right;" *ngIf="estatusSeleccionadas">
            <label for="exampleSelect1">
                Estado
            </label>
            </div>
            <div class="form-group m-form__group col-md-3 col-lg-3 col-sm-11" *ngIf="estatusSeleccionadas">
            <select class="form-control m-input" id="exampleSelect1"   [(ngModel)]="estatusFilters.estado" (change)="getEstatus()" name="estado">
                <option [ngValue]="-1">
                    Todos
                </option>
                <option *ngFor="let estado of estadosArticulo" [value]="estado.id">
                    {{estado.nombre}}
                </option>
            </select>
        </div>
    </div>
    <ul class="nav nav-tabs  m-tabs-line m-tabs-line--success" role="tablist">
     
        <li class="nav-item m-tabs__item" (click)="seleccionarTab('enBodegaSeleccionadas')">
            <a class="nav-link m-tabs__link active" data-toggle="tab" href="#enBodegaTab" role="tab">
                En Bodega <span class="m-badge m-badge--success" *ngIf="totalEnBodega">{{totalEnBodega}}</span>
            </a>
        </li>
        <li class="nav-item m-tabs__item" (click)="seleccionarTab('embarcadosSeleccionadas')">
            <a class="nav-link m-tabs__link" data-toggle="tab" href="#embarcadosTab" role="tab">
                Por Embarcar <span class="m-badge m-badge--success" *ngIf="totalEmbarcados">{{totalEmbarcados}}</span>
            </a>
        </li>
        <!-- <li class="nav-item m-tabs__item" (click)="seleccionarTab('enTransitoSeleccionadas')">
            <a class="nav-link m-tabs__link" data-toggle="tab" href="#enTransitoTab" role="tab">
                En Tránsito <span class="m-badge m-badge--success" *ngIf="totalEnTransito">{{totalEnTransito}}</span>
            </a>
        </li> -->
        <li class="nav-item m-tabs__item" (click)="seleccionarTab('facturacionSeleccionadas')">
            <a class="nav-link m-tabs__link" data-toggle="tab" href="#facturacionTab" role="tab">
                En el País <span class="m-badge m-badge--success" *ngIf="totalFacturacion">{{totalFacturacion}}</span>
            </a>
        </li>
        <li class="nav-item m-tabs__item" (click)="seleccionarTab('rutaNacionalSeleccionadas')">
            <a class="nav-link m-tabs__link" data-toggle="tab" href="#rutaNacionalTab" role="tab">
                Por Entregar <span class="m-badge m-badge--success" *ngIf="totalRutaNacional">{{totalRutaNacional}}</span>
            </a>
        </li>
        <li class="nav-item m-tabs__item" hidden (click)="seleccionarTab('entregadosSeleccionadas')">
            <a class="nav-link m-tabs__link" data-toggle="tab" href="#entregadosTab" role="tab">
                Entegados <span class="m-badge m-badge--success" *ngIf="totalEntregados">{{totalEntregados}}</span>
            </a>
        </li>
        <li class="nav-item m-tabs__item" (click)="seleccionarTab('estatusSeleccionadas')">
            <a class="nav-link m-tabs__link " data-toggle="tab" href="#estatusTab" role="tab">
                Estatus <span class="m-badge m-badge--success" *ngIf="totalEstatus">{{totalEstatus}}</span>
            </a>
        </li>
    </ul>
    <div class="tab-content">
        <div class="tab-pane" id="enBodegaTab" role="tabpanel" [class.active]="enBodegaSeleccionadas">
            <div class="m-portlet m-portlet--mobile">
                <div class="m-portlet__body">

                    <!--begin: Search Form -->
                    <div class="m-form m-form--label-align-right m--margin-top-20 m--margin-bottom-30">
                        <app-en-bodega-list-header [totalEnBodega]="enBodegaSeleccion.length" [selection]="enBodegaSeleccion"
                            (consolidar)="onConsolidar()"
                            (embarcar)="onEmbarcar(embarcar)"
                            (exportar)="onExportar()"
                            [puedeDV]="puedeDV"
                            [puedeFactura]="puedeFactura"
                            [consolidarPaquete]="consolidarPaquete"
                            [enviarPaquete]="enviarPaquete"
                            (DVMasiva)="OnModalDV(declaracionModal)"
                            (facturaMasiva)="OnModalFactura(facturaMasivaModal)"
                        ></app-en-bodega-list-header>
                    </div>
                    <!--end: Search Form -->        <!--begin: Datatable -->
                    <div class="row" style="justify-content: center">
                        <div class="m-loader" style="width: 30px;" *ngIf="!enBodega && enBodegaSeleccionadas"></div>
                    </div>
                    <app-en-bodega-datatable
                            *ngIf="enBodega && enBodegaSeleccionadas"
                            [data]="enBodega"
                            (ver)="verImagenes($event, imagenesModal)"
                            [totalItems]="totalEnBodega"
                            [filters]="enBodegaFilters"
                            [url]="urlfactura"
                            (dvSelection)= "onPuedeDV($event)"
                            (cargar)= "getEnBodega($event)"
                            (trackboxOutput)= "onTrackbox($event)"
                            (addFactura)="onSubirFactura($event)"
                            (filtersChange)="onEnBodegaFiltersChange($event)"
                            (selectionChange)="onEnBodegaSelectionChange($event)"
                            (datosSelection)= "onDatos($event)"
                            (preciosSelection)= "onSelectionPrecios($event)"
                            (facturaSelection)= "onPuedeFactura($event)"
                            (consolidarSelection)= "onConsolidarPaquete($event)"
                            (enviarSelection)= "onEnviarPaquete($event)"
                    ></app-en-bodega-datatable>
                </div>
                <!--end: Datatable -->
            </div>
        </div>
        <div class="tab-pane" id="embarcadosTab" role="tabpanel" [class.active]="embarcadosSeleccionadas">
            <div class="m-portlet m-portlet--mobile">
                <div class="m-portlet__body">

                    <div class="row" style="justify-content: center">
                        <div class="m-loader" style="width: 30px;" *ngIf="!embarcados && embarcadosSeleccionadas"></div>
                    </div>
                    <app-embarcados-datatable
                            *ngIf="embarcados && embarcadosSeleccionadas"
                            [data]="embarcados"
                            (ver)="verImagenes($event, imagenesModal)"
                            (filtersChange)="onEmbarcadosFiltersChange($event)"
                            (cargar)= "getEmbarcados($event)"
                            [totalItems]="totalEmbarcados"
                            [filters]="embarcadosFilters"
                            [url]="urlfactura"
                    ></app-embarcados-datatable>
                </div>
                <!--end: Datatable -->
            </div>
        </div>
        <div class="tab-pane" id="enTransitoTab" role="tabpanel" [class.active]="enTransitoSeleccionadas">

            <div class="m-portlet m-portlet--mobile">
                <div class="m-portlet__body">
                    <div class="row" style="justify-content: center">
                        <div class="m-loader" style="width: 30px;"
                             *ngIf="!enTransito && enTransitoSeleccionadas"></div>
                    </div>
                    <app-en-transito-datatable
                            *ngIf="enTransito && enTransitoSeleccionadas"
                            [data]="enTransito"
                            (ver)="verImagenes($event, imagenesModal)"
                            [totalItems]="totalEnTransito"
                            [filters]="enTransitoFilters"
                            (filtersChange)="onEnTransitoFiltersChange($event)"
                    ></app-en-transito-datatable>
                </div>
                <!--end: Datatable -->
            </div>
        </div>

        <div class="tab-pane" id="facturacionTab" role="tabpanel" [class.active]="facturacionSeleccionadas">

            <div class="m-portlet m-portlet--mobile">
                <div class="m-portlet__body">
                    <div class="row" style="justify-content: center">
                        <div class="m-loader" style="width: 30px;"
                             *ngIf="!facturacion && facturacionSeleccionadas"></div>
                    </div>
                    <app-facturacion-datatable
                            *ngIf="facturacion && facturacionSeleccionadas"
                            [data]="facturacion"
                            (ver)="verImagenes($event, imagenesModal)"
                            [totalItems]="totalFacturacion"
                            [filters]="facturacionFilters"
                            (filtersChange)="onFacturacionFiltersChange($event)"
                    ></app-facturacion-datatable>
                </div>
                <!--end: Datatable -->
            </div>
        </div>

        <div class="tab-pane" id="rutaNacionalTab" role="tabpanel" [class.active]="rutaNacionalSeleccionadas">

            <div class="m-portlet m-portlet--mobile">
                <div class="m-portlet__body">
                    <div class="row" style="justify-content: center">
                        <div class="m-loader" style="width: 30px;"
                             *ngIf="!rutaNacional && rutaNacionalSeleccionadas"></div>
                    </div>
                    <app-ruta-nacional-datatable
                            *ngIf="rutaNacional && rutaNacionalSeleccionadas"
                            [data]="rutaNacional"
                            (ver)="verImagenes($event, imagenesModal)"
                            [totalItems]="totalRutaNacional"
                            [filters]="rutaNacionalFilters"

                            (filtersChange)="onRutaNacionalFiltersChange($event)"
                    ></app-ruta-nacional-datatable>
                </div>
                <!--end: Datatable -->
            </div>
        </div>

        <div class="tab-pane" id="entregadosTab" hidden role="tabpanel" [class.active]="entregadosSeleccionadas">

            <div class="m-portlet m-portlet--mobile">
                <div class="m-portlet__body">
                    <div class="row" style="justify-content: center">
                        <div class="m-loader" style="width: 30px;"
                             *ngIf="!entregados && entregadosSeleccionadas"></div>
                    </div>
                    <app-entregados-datatable
                            *ngIf="entregados && entregadosSeleccionadas"
                            [data]="entregados"
                            [totalItems]="totalEntregados"
                            (ver)="verImagenes($event, imagenesModal)"
                            [filters]="entregadosFilters"

                            (filtersChange)="onEntregadosFiltersChange($event)"
                    ></app-entregados-datatable>
                </div>
                <!--end: Datatable -->
            </div>
        </div>
       
        <div class="tab-pane" id="estatusTab" role="tabpanel" [class.active]="estatusSeleccionadas">
            <div class="m-portlet m-portlet--mobile">
                <div class="m-portlet__body">

                    <!--begin: Search Form -->
                    <div class="m-form m-form--label-align-right m--margin-top-20 m--margin-bottom-30">
                        <app-estatus-list-header [puedeEntrega]="puedeEntrega" [totalEstatus]="estatusSeleccion.length" [selection]="estatusSeleccion"
                            (exportar)="onExportarEstatus()" (entrega)="onEntrega(entregaModal)"
                        ></app-estatus-list-header>
                    </div>
                    <!--end: Search Form -->        <!--begin: Datatable -->
                    <div class="row" style="justify-content: center">
                        <div class="m-loader" style="width: 30px;" *ngIf="!estatus && estatusSeleccionadas"></div>
                    </div>
                    <app-estatus-datatable
                            *ngIf="estatus && estatusSeleccionadas"
                            [data]="estatus"
                            (ver)="verImagenes($event, imagenesModal)"
                            [totalItems]="totalEstatus"
                            [filters]="estatusFilters"
                            [url]="urlfactura"
                            (dvSelection)= "onPuedeDV($event)"
                            (cargar)= "getEstatus($event)"
                            (entregaSelection)= "onPuedeEntrega($event)"
                            (filtersChange)="onEstatusFiltersChange($event)"
                            (articuloChange)="onArticuloChange($event)"
                            (selectionChange)="onEstatusSelectionChange($event)"
                    ></app-estatus-datatable>
                </div>
                <!--end: Datatable -->
            </div>
        </div>
    </div>
</div>

<!--begin::Images Modal-->
<ng-template #imagenesModal let-c="close" let-d="dismiss">
    <div class="modal-header">
        <h4 class="modal-title">Imágenes</h4>
        <button type="button" class="close" aria-label="Close" (click)="c('Cross click')">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <div class="modal-body row">
        <div *ngFor="let image of articulo[0]" class="col-md-4 col-lg-4 col-sm-12 col-xs-12">
            <img [src]="articulo[1]+image.url" style="width: 150px; height: 150px; object-fit: contain">
        </div>
    </div>
</ng-template>
<!--end::Modal-->  <!--begin::Modal-->


<!--begin::View  Modal-->
<ng-template #facturaMasivaModal let-c="close" let-d="dismiss">
    <div class="modal-header">
        <h4 class="modal-title">Factura masiva</h4>
        <button type="button" class="close" aria-label="Close" (click)="close()">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <div class="modal-body">
        <div class="m-portlet__head-caption">
            <div class="m-list-settings">
                <form class="m-form m-form--fit m-form--label-align-right m-form--group-seperator-dashed"
                      #facturaForm="ngForm" (submit)="onSubmitFactura(facturaForm.value)">
                    <div class="m-portlet__body">
        
                        <div class="form-group m-form__group row">
                            <label class="col-lg-3 col-form-label">
                                Factura*:
                            </label>
                            <div class="input-group col-lg-6" style="padding-top: 10px;">
                                <input required
                                name="archivo"
                                type="file"
                                hidden
                                #fileInput
                                (change)="onSubirFacturaInput($event)"
                        >
                    <i class="fa fa-folder-open m--font-success" style="cursor: pointer" title="Subir Factura" (click)="fileInput.click()" ></i>
                    <span *ngIf="file">{{ file.name }}</span>      
                            </div>
                        </div>
                    </div>
                    <div class="form-group m-form__group row">
                        <div class="col-lg-3">
                        <input type="text" class="form-control m-input" 
                        [(ngModel)]="nombreTrackbox" #nombre="ngModel"
                        name="nombre" hidden placeholder="Nombre Factura"
                        required>
                        </div>
                    </div>
                    <div class="m-portlet__foot m-portlet__no-border m-portlet__foot--fit">
                        <div class="m-form__actions m-form__actions--solid">
                            <div class="row">
                                <div class="col-lg-2"></div>
                                <div class="col-lg-10">
                                    <button type="submit"
                                            [disabled]="!fileInput.value && !nombre.value"
                                            [class]="(facturaForm.invalid == false) ? 'btn btn-success' : 'btn btn-danger'"
                                    >
                                        Guardar
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>

        </div>
    </div>
</ng-template>
<!--end::Modal-->

<!--begin::View  Modal-->
<ng-template #embarcar let-c="close" let-d="dismiss">
    <div class="modal-header">
        <h4 class="modal-title">Embarcar</h4>
        <button type="button" class="close" aria-label="Close" (click)="close()">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <div class="modal-body">
        <div class="m-portlet__head-caption">
            <div class="m-list-settings">
                <div class="row" style="margin: 5px">
                    <h3>Se embarcarán estos artículos</h3>
                </div>
                <div class="table-responsive">
                <table class="table table-bordered table-responsive m-table m-table--head-bg-brand">
                    <thead>
                    <tr>
                        <th>
                            TRACKBOX
                        </th>
                        <th>
                            Track Remitente
                        </th>
                        <th>Descripción </th>
                         <th>
                            Piezas
                        </th>
                          <th>
                            Dimensiones(In)
                        </th>
                        <th>
                            Peso(Lb)
                        </th>
                      
                        <th>
                            Costo(USD)
                        </th>  
                         
                    </tr>
                    </thead>
                    <tbody>
                    <tr *ngFor="let articulo of articulos">
                        
                        <td>
                            <p *ngIf="articulo.trackbox">{{ articulo.trackbox }}</p>
                            <i class="fa fa-warning" *ngIf="!articulo.trackbox"></i>
                        </td>
                         <td>
                            {{ articulo.tracking }}
                        </td>
                          <td>{{ articulo.descripcion }}</td>
                           <td>
                            {{ articulo.piezas }}
                        </td>
                         <td>
                            {{ articulo.largo }}x{{articulo.ancho}}x{{articulo.alto}}
                        </td>
                        <td>
                            {{ articulo.peso | number:'1.2-2' }}
                        </td>
                       
                        <td>
                            {{ articulo.precio }}
                        </td>
                      
                    </tr>
                    <tr>
                        <td colspan="5" style="text-align: center;"><h4>Total</h4></td>
                        <td>{{ totalPeso | number:'1.2-2' }}</td>
                        <td>{{ totalPrecio }}</td>
                    </tr>
                    </tbody>
                </table>
                </div>
                <div *ngIf="existeRemitente"
                class="col-12"
                style="background-color: #676c7bd8; color: white; margin: 3px"
                >
                    <span>Debe seleccionar Remitente porque no coinciden los artículos seleccionados.</span>
                </div>
                <div *ngIf="existeImporter"
                class="col-12"
                style="background-color: #676c7bd8; color: white; margin: 3px"
                >
                    <span>Debe seleccionar Importer porque no coinciden los artículos seleccionados.</span>
                </div>
                <div class="row" style="margin: 5px">
                    <h4>Puede cambiar los datos de embarque sino se tomarán los iniciales por defecto</h4>
                </div>
                <form class="m-form m-form--fit m-form--label-align-right m-form--group-seperator-dashed"
                      #embarcarForm="ngForm"  (submit)="onSubmitEmbarcar(embarcarForm.value)">
                    <div class="m-portlet__body">
                   
                    <div class="form-group m-form__group row" style="padding-top:10px !important;">
                            <label class="col-lg-3 col-form-label">
                                Remitente:
                            </label>
                            <div class="col-lg-4">
                                <input type="text" class="form-control m-input" placeholder="Tienda o Usuario NO REGISTRADO"
                                [(ngModel)]="text"  #remitente_text="ngModel"
                                name="remitente_text" (keyup)= "validarForm()"
                                >
                            </div>
                            <div class="col-lg-4">
                                <div class="m-loader m-loader--primary m-loader--right" *ngIf="!usuarios">
                                    <input type="text" class="form-control"/>
                                </div>
                                <app-auto-complete *ngIf="usuarios" placeholder="SOLO PARA MIGRANTES"
                                                    [(ngModel)]="remitente_usuario" #remitente_id="ngModel"
                                                    name="remitente_id"  [items]="usuarios"
                                                    [textField]="'numero_identidad'"
                                                    textField1="nombre"
                                                    textField2="apellido"
                                                    valueField="numero_identidad"
                                                    [isModal]="true"
                                                    (change)= "validarForm()"
                                ></app-auto-complete>
                            </div>
                         
                        </div>
                        <div class="form-group m-form__group row">
                           
                            <label class="col-lg-3 col-form-label">
                                Consignatario*:
                            </label>
                            <div class="col-lg-4">
                                <div class="m-loader m-loader--primary m-loader--right" *ngIf="!usuarios_importer">
                                    <input type="text" class="form-control"/>
                                </div>
                                <app-auto-complete *ngIf="usuarios_importer" placeholder="Seleccione"
                                                    [(ngModel)]="importer_usuario" #importer="ngModel"
                                                    name="importer" [items]="usuarios_importer"
                                                    [textField]="'numero_identidad'"
                                                    textField1="nombre"
                                                    textField2="apellido"
                                                    valueField="numero_identidad"
                                                    [isModal]="true"
                                                    (change)= "validarForm()"
                                ></app-auto-complete>
                            </div>
                            <label class="col-lg-3 col-form-label" *ngIf="!consolidadoFact">
                                Unidades Físicas:
                             </label>
                             <div class="col-lg-2">
                                 <h5 *ngIf="dv && !consolidadoFact" class="text-left" style="margin-top: 10px;">{{ unidades }} </h5>
                                 <input type="number" min="0" *ngIf="!dv && !consolidadoFact" class="form-control m-input" placeholder="Unidades"
                                 [(ngModel)]="unidades"  #unidad="ngModel"
                                 name="unidad" required
                                 > 
                             </div>
                        </div>
                        
                         <div class="form-group m-form__group row">
                         <div class="col-lg-12" >
                            <label class="col-lg-12 col-form-label">
                                Cambiar descripción si es necesario:
                             </label><br/>
                             <input  *ngIf="!consolidadoFact"  type="text" class="form-control m-input" placeholder="Descripción"
                             [(ngModel)]="descripcionembarque"  #descripcion="ngModel"
                             name="descripcion"
                             > 
                        
                         <div class="table-responsive"  *ngIf="consolidadoFact">
                            <table class="table table-bordered table-responsive m-table m-table--head-bg-brand">
                                <thead>
                                <tr>
                                    <th>
                                        TRACKBOX
                                    </th>
                                   
                                    <th>Descripción </th>
                                    <th>Unidades </th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr *ngFor="let a of articulos">
                                    
                                    <td>
                                        <p *ngIf="a.trackbox">{{ a.trackbox }}</p>
                                        <i class="fa fa-warning" *ngIf="!a.trackbox"></i>
                                    </td>
                                    
                                    <td> 
                                        <input type="text" class="form-control m-input" placeholder="Descripción"
                                        [(ngModel)]="a.descripcion_embarque"  #descripcion+{{a.id}}="ngModel"
                                        name="descripcion+{{a.id}}"
                                        > 
                                    </td>
                                    <td>
                                        <input type="number" *ngIf="!a.fac_d_v" min="0" class="form-control m-input" placeholder="Unidades"
                                        [(ngModel)]="a.unidades"  #unidad+{{a.id}}="ngModel"
                                        name="unidad+{{a.id}}" required
                                        > 
                                        <h5 *ngIf="a.fac_d_v" class="text-left">{{ a.unidades }} </h5>
                                    </td>
                                </tr>
                              
                                </tbody>
                            </table>
                            </div>
                        </div>
                        </div>
                        <div class="form-group m-form__group row">
                           
                            <label class="col-lg-3 col-form-label">
                                Categoría o partida arancelaria:
                            </label>
                            <div class="col-lg-3">
                                <select class="form-control m-input" placeholder="Categoría"
                                [(ngModel)]="arancel" #categoria="ngModel" name="categoria" required>
                                    <option *ngFor="let arancel of arancelesCat" [ngValue]="arancel.codigo">
                                        {{arancel.codigo}}
                                    </option>
                                </select>
                            </div>
                            <div class="col-lg-6">
                                <input type="text" maxlength="255" class="form-control m-input" placeholder="Categoría o partida arancelaria"
                                [(ngModel)]="notaembarque"  #nota="ngModel"
                                name="nota"
                                > 
                            </div>
                        </div>
                        <div class="form-group m-form__group row">
                            <div class="col-lg-3"><span>
                                A - DOCUMENTOS <br/>
                                B- 4X4</span>
                            </div>
                        
                        <div class="col-lg-5">
                            <span>
                            C-  COURIER CON PARTIDA ARANCELARIA <br/>
                            D - PRENDAS DE VESTIR, TEXTILES CONFECCIONADOS Y CALZADO 
                            </span>
                        </div>
                        
                        <div class="col-lg-4"><span>
                            E - MEDICINAS CON RECETAS <br/>
                            F - EQUIPOS DE COMPUTADORA Y LIBROS <br/>
                            G - MIGRANTES</span>
                        </div>
                      
                    </div>
                    </div>
                    <div class="m-portlet__foot m-portlet__no-border m-portlet__foot--fit">
                        <div class="m-form__actions m-form__actions--solid">
                            <div class="row" *ngIf="mensaje">
                                <div class="col-lg-1"></div>
                                <div class="col-lg-11">
                                   <h4>¿Está seguro de embarcar?</h4>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-lg-2"></div>
                                <div class="col-lg-10">
                                    <button *ngIf="!confirmar"
                                            [disabled]="validar || (!consolidadoFact && unidades == 0)"
                                            [class]="(embarcarForm.invalid == false) ? 'btn btn-success' : 'btn btn-danger'"
                                            >
                                        Guardar
                                    </button>
                                    <button *ngIf="confirmar"
                                        [disabled]="validar || (!consolidadoFact && unidades == 0)"
                                        [class]="(embarcarForm.invalid == false) ? 'btn btn-success' : 'btn btn-danger'"
                                        type="submit">
                                        SI
                                    </button> 
                                    <button *ngIf="confirmar" class="btn btn-secondary"
                                    (click)="negadaConfirmacion()">
                                        NO
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>

        </div>
    </div>
</ng-template>
<!--end::Modal-->

<!--begin::View  Modal-->
<ng-template #noticiaModal let-c="close" let-d="dismiss">
    <div class="modal-header">
        <h4 class="modal-title">Noticias</h4>
    </div>
    <div class="modal-body">
        <div class="m-portlet__head-caption">
            
            <div class="m-list-settings">
                <div class="m-dropdown__content">
                    <div class="m-list-timeline m-list-timeline--skin-light">
                        <div class="m-list-timeline__items">
                            <div class="m-list-timeline__item"
                                 *ngFor="let noticia of appService.noticias">
                                <span class="m-list-timeline__badge -m-list-timeline__badge--state-success"></span>
                                <span class="m-list-timeline__text" style="font-size: 1.2rem !important; color:#1e1111 !important">
                                    {{noticia.fecha}} -- {{noticia.texto}}
                            </span>
                               
                            </div>
                        </div>
                    </div>
                   
                </div>
            </div>
            <div class="m-portlet__foot m-portlet__no-border m-portlet__foot--fit">
                        <div class="m-form__actions m-form__actions--solid">
                            <div class="row mb-10">
                                <div class="col-lg-12 text-right">
                                    <button (click)="leidas()"
                                            class="btn btn-success">
                                        Leídas
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
        </div>

    </div>
</ng-template>
<!--end::Modal-->

<!--begin::View  Modal-->
<ng-template #declaracionModal let-c="close" let-d="dismiss">
    <div class="modal-header">
        <h4 class="modal-title">Declaración de valores masiva</h4>
        <button type="button" class="close" aria-label="Close" (click)="close()">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <div class="modal-body">
        <div class="m-portlet__head-caption">
            <div class="m-list-settings">
                <form class="m-form m-form--fit m-form--label-align-right m-form--group-seperator-dashed"
                      #declaracionForm="ngForm" (submit)="onSubmit(declaracionForm.value)">
                    <div class="m-portlet__body">
                        <input type="text" class="form-control m-input" 
                        [(ngModel)]="enBodegaSeleccion" #ids="ngModel"
                        name="ids"
                        required hidden>
                        <div class="form-group m-form__group row">
                            <label class="col-lg-3 col-form-label">
                                Fecha de Expiración*:
                            </label>
                            <div class="input-group col-lg-3">
                                <input class="form-control" placeholder="yyyy-mm-dd"
                                    name="fecha_expiracion" #fecha_expiracion="ngModel" [(ngModel)]="articulodv.fecha_expiracion_d_v"
                                    ngbDatepicker #d="ngbDatepicker" (click)="d.toggle()" required>
                                <div class="input-group-append">
                                    <button class="btn btn-outline-secondary" 
                                        style="color: #575962; background-color: white; line-height: initial; margin-left: -1px;"
                                        (click)="d.toggle()" type="button">
                                        <i class="fa fa-calendar" style="width: 1.2rem; height: 1rem; cursor: pointer;"></i>
                                    </button>
                                </div>
                                
                            </div>
                            <label class="col-lg-2 col-form-label">
                                AWB*:
                            </label>
                            <div class="col-lg-3">
                                <input type="text" class="form-control m-input" 
                                       [(ngModel)]="articulodv.trackbox" #awb="ngModel"
                                       name="awb"
                                       required >
                            </div>
                            </div>
                             <div class="form-group m-form__group row">
                            <label class="col-lg-3 col-form-label">
                                Remitente:
                            </label>
                            <div class="col-lg-4">
                                <input type="text" class="form-control m-input" placeholder="Tienda o Usuario NO REGISTRADO"
                                [ngModel]="articulodv.tienda_d_v"  #remitente_text="ngModel"
                                name="remitente_text"
                                >
                            </div>
                            <div class="col-lg-4">
                                <div class="m-loader m-loader--primary m-loader--right" *ngIf="!usuarios">
                                    <input type="text" class="form-control"/>
                                </div>
                                <app-auto-complete *ngIf="usuarios" placeholder="USUARIO REGISTRADO"
                                                    [ngModel]="remitente_usuario" #remitente_id="ngModel"
                                                    name="remitente_id"  [items]="usuarios"
                                                    [textField]="'numero_identidad'"
                                                    textField1="nombre"
                                                    textField2="apellido"
                                                    valueField="numero_identidad"
                                ></app-auto-complete>
                            </div>
                         
                        </div>
                        <div class="form-group m-form__group row">
                           
                            <label class="col-lg-3 col-form-label">
                                Importer*:
                            </label>
                            <div class="col-lg-4">
                                <div class="m-loader m-loader--primary m-loader--right" *ngIf="!usuarios_importer">
                                    <input type="text" class="form-control"/>
                                </div>
                                <app-auto-complete *ngIf="usuarios_importer" placeholder="Seleccione"
                                                    [ngModel]="importer_usuario" #importer="ngModel"
                                                    name="importer" required [items]="usuarios_importer"
                                                    [textField]="'numero_identidad'"
                                                    textField1="nombre"
                                                    textField2="apellido"
                                                    valueField="numero_identidad"
                                ></app-auto-complete>
                            </div>
                          
                        </div>

                          
                        <div class="form-group m-form__group row">
                            
                            <label class="col-lg-3 col-form-label">
                                País origen*:
                            </label>
                            <div class="col-lg-3">
                                <select type="text" class="form-control m-input"
                                [(ngModel)]="pais_origen_d_v_id" #pais_origen="ngModel" name="pais_origen" required>
                                <option *ngFor="let pais of paises" [ngValue]="pais.id">
                                    {{pais.nombre}}
                                </option>
                                </select>
                                <section *ngIf="pais_origen.invalid && pais_origen.dirty" class="bs">
                                    <p class="m--font-danger" *ngIf="pais_origen.hasError('required')">El pais origen es requerido</p>
                                </section>
                            </div>
                            <label class="col-lg-2 col-form-label">
                                País destino*:
                            </label>
                            <div class="col-lg-3">
                                <select type="text" class="form-control m-input"
                                [(ngModel)]="pais_destino_d_v_id" #pais_destino="ngModel" name="pais_destino" required>
                                <option *ngFor="let pais of paises" [ngValue]="pais.id">
                                    {{pais.nombre}}
                                </option>
                                </select>
                                <section *ngIf="pais_destino.invalid && pais_destino.dirty" class="bs">
                                    <p class="m--font-danger" *ngIf="pais_destino.hasError('required')">El pais destino es requerido</p>
                                </section>
                            </div>

                        </div>

                        <!-- Editable table -->
                        <div class="form-group m-form__group row">  
                            <div class="card col-lg-12">
                                <div class="card-body">
                                <div id="table" class="table-editable">
                                   <span class="btn btn-info m-btn m-btn--custom m-btn--icon m-btn--air m-btn--pill" style="float: right; width: 120px; margin-bottom:10px;font-size: 1.0rem !important;" (click)="add()">
                                        <i class="fa fa-plus" style="float: left; padding: 2.5px;"></i>
                                        <span>
                                            Agregar
                                        </span>
                                    </span> 
                                   
                                    <table class="table table-bordered table-responsive-md  table-responsive table-striped text-center table-description">
                                    <tr>
                                        <th class="text-center" style="font-size: 1.1em !important;">Descripción</th>
                                        <th class="text-center" style="font-size: 1.1em !important;">Cantidad</th>
                                        <th class="text-center" style="font-size: 1.1em !important;">Valor unitario</th>
                                        <th class="text-center" style="font-size: 1.1em !important;">Valor total</th>
                                         <th class="text-center" style="font-size: 1.1em !important;">Acciones</th> 
                                    </tr>
                                    <tr *ngFor="let person of paqueteList[0]; let id = index">
                                      
                                        <td  style="font-size: 1.1em !important;">
                                        <span contenteditable="true" (keyup)="changeValue(id, 'descripcion', $event);" (blur)="updateList(id, 'descripcion', $event)"  style="padding:5px; text-align:center;">{{person.descripcion}}</span>
                                        </td>
                                        <td style="font-size: 1.1em !important;">
                                        <span contenteditable="true" (keyup)="changeValue(id, 'cantidad', $event);" (blur)="updateList(id, 'cantidad', $event)"  style="padding:5px; text-align:center;">{{person.cantidad}}</span>
                                        </td>
                                        <td style="font-size: 1.1em !important;">
                                        <span contenteditable="true" (keyup)="changeValue(id, 'vunitario', $event);" (blur)="updateList(id, 'vunitario', $event)"  style="padding:5px; text-align:center;">{{person.vunitario}}</span>
                                        </td>
                                        <td style="font-size: 1.1em !important;">{{(person.total) ? person.total : 0}}</td>
                                        <td style="font-size: 1.1em !important;"> <span class="table-remove">
                                            <i class="fa fa-trash m--font-danger" title="Eliminar" style="cursor: pointer" 
                                            (click)="remove(id)"></i>
                                        </span>
                                        </td> 
                                    </tr>  
                                   <!--  <tr *ngFor="let person of paqueteList; let id = index">
                                        <td>{{person.numero}}</td>
                                        <td>{{person.descripcion}}</td>
                                        <td>{{person.peso}}</td>
                                        <td>
                                            <span contenteditable="true" (keyup)="changeValue(id, 'cantidad', $event);changeValue(id, 'total', person.cantidad * person.vunitario)" (blur)="updateList(id, 'cantidad', $event);updateList(id, 'total',  person.cantidad * person.vunitario)"  style="padding:5px; text-align:center;">Ingrese Cantidad</span>
                                            </td>
                                        <td>{{person.vunitario}}</td>
                                        <td>{{(person.cantidad * person.vunitario) ? person.cantidad * person.vunitario : 0}}</td>
                                    </tr> -->
                                    </table>
                                </div>
                                </div>
                             </div>
                        </div>
                        <!-- Editable table -->
                    <input type="text"  [ngModel]="paqueteList" #descripciones="ngModel"
                    name="descripciones" style="display: none;">
                    </div>
                    <div class="m-portlet__foot m-portlet__no-border m-portlet__foot--fit">
                        <div class="m-form__actions m-form__actions--solid">
                            <div class="row">
                                <div class="col-lg-2"></div>
                                <div class="col-lg-10">
                                    <button type="submit"
                                            [disabled]="declaracionForm.invalid"
                                            [class]="(declaracionForm.invalid == false) ? 'btn btn-success' : 'btn btn-danger'"
                                    >
                                        Guardar
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>

        </div>
    </div>
</ng-template>


<!--begin::View  Modal-->
<ng-template #entregaModal let-c="close" let-d="dismiss">
    <div class="modal-header">
        <h4 class="modal-title">Crear Entrega</h4>
        <button type="button" class="close" aria-label="Close" (click)="d('Cross click')">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <div class="modal-body">
        <div class="m-portlet__head-caption">
            <div class="m-list-settings">
                <form class="m-form m-form--fit m-form--label-align-right m-form--group-seperator-dashed"
                      #entregaForm="ngForm" (submit)="onSubmitEntrega(entregaForm.value)">
                    <div class="m-portlet__body">
                        <div class="form-group m-form__group row">
                            <label class="col-lg-3 col-form-label">
                                <h5> Tipo de entrega</h5>
                            </label>
                            <div class="col-lg-9">
                                <select #domicilio_retiro="ngModel"  [(ngModel)]="entrega.domicilio" name="domicilio_retiro" class="form-control m-input" (change)="domicilioValue(domicilio_retiro.value)">
                                    <option value= "1">DOMICILIO</option>
                                    <option value= "0">RETIRO PUNTO TRAMACO</option>
                                    <option value= "2">RETIRO MATRIZ</option>
                                </select>
                            </div>
                           
                        </div>
                        <div class="form-group m-form__group row" *ngIf= "entrega.domicilio == 0 || domicilio == 2">
                            <label class="col-lg-3 col-form-label">
                                <h5 >Dónde se retira:</h5>  
                            </label>
    
                        </div>
                        
                        <div class="form-group m-form__group row" *ngIf= "entrega.domicilio == 0 || domicilio == 2">
                             <label class="col-lg-3 col-form-label">
                                País:
                            </label>
                            <div class="col-lg-3">
                                
                                <select  class="form-control m-input" placeholder="País" (change)="getProvinciasR(pais_id.value)"
                                        [(ngModel)]="entrega.ciudad_retiro.provincia.pais.id" #pais_id="ngModel" name="pais_id"
                                        disabled={{disabled}}>
                                    <option [value]="" disabled>Seleccione un País</option>
                                    <option *ngFor="let pais of paisesEntrega" [value]="pais.id" >
                                        {{pais.nombre}}
                                    </option>
                                </select>
                            </div>
                            <label class="col-lg-3 col-form-label">
                                Provincia:
                            </label>
                            <div class="col-lg-3">
                                <app-auto-complete *ngIf="provinciasR" placeholder="Seleccione"
                                [(ngModel)]="entrega.ciudad_retiro.provincia.id" #provinciaRetiro_id="ngModel"
                                name="provinciaRetiro_id" required [items]="provinciasR" [disabled]="disabled"
                                [textField]="'nombre'"
                                valueField="id" 
                                (change)="getCiudadesR(provinciaRetiro_id.value)"
                                 ></app-auto-complete>
                            
                            </div>
                        </div>
                        <div class="form-group m-form__group row" *ngIf= "entrega.domicilio == 0 || domicilio == 2">
                            <label class="col-lg-3 col-form-label">
                                Ciudad:
                            </label>
                            <div class="col-lg-4">
                                <app-auto-complete *ngIf="ciudadesR" placeholder="Seleccione"
                                [(ngModel)]="entrega.ciudad_retiro.id" #ciudadRetiro_id="ngModel"
                                name="ciudadRetiro_id" required [items]="ciudadesR" [disabled]="disabled"
                                [textField]="'nombre'" (change)="getParroquiasR(ciudadRetiro_id.value)"
                                valueField="id" 
                                 ></app-auto-complete>
                            
                            </div>
                            <div class="col-lg-5">
                                <input type="text" class="form-control m-input" placeholder="Ciudad Manual" disabled={{disabled}}
                                [ngModel]="entrega.ciudad_retiro_text" #ciudadretirotext="ngModel" name="ciudadretirotext">
                            </div>
                        </div>
                        <div class="form-group m-form__group row" *ngIf= "entrega.domicilio == 0 || domicilio == 2">
                        <label class="col-lg-3 col-form-label">
                            Parroquía:
                        </label>
                        <div class="col-lg-3">
                            <app-auto-complete *ngIf="parroquiasR" placeholder="Seleccione"
                            [ngModel]="entrega.parroquia_retiro.id" #parroquiaRetiro_id="ngModel"
                            name="parroquiaRetiro_id"  [items]="parroquiasR" [disabled]="disabled"
                            [textField]="'nombre'"
                            valueField="id" 
                             ></app-auto-complete>
                        
                        </div>
                        </div>
                        
                        <div class="form-group m-form__group row" *ngIf= "entrega.domicilio == 0 || domicilio == 2">
                            <label class="col-lg-3 col-form-label">
                                Otra Información:
                            </label>
                            <div class="col-lg-9">
                                <textarea class="form-control m-input" placeholder="Anotación"
                                          [ngModel]="entrega.nota_retiro" #notaRetiro="ngModel"
                                          name="notaRetiro">
                                </textarea>
                            </div>
                        </div>
                        <div class="form-group m-form__group row">
                            <div class="col-lg-9">
                                <h5 *ngIf= "entrega.domicilio == 0 || domicilio == 2">Datos de la persona que retira:</h5> 
                                <h5 *ngIf= "entrega.domicilio == 1">Datos del domicilio:</h5> 
                            </div>
                        </div>
                        <div class="form-group m-form__group row">
                            <label class="col-lg-3 col-form-label">
                                <h5> Tipo de usuario</h5>
                            </label>
                            <div class="col-lg-9">
                                <select class="form-control m-input" [(ngModel)]="selectUsuario" #selected="ngModel" name="selected" (change)="selectedValue(selected.value)">
                                    <option value= "1">Usuario Existente en sistema</option>
                                    <option value= "0">Usuario no existente en sistema</option>
                                </select>
                            </div>
                           
                        </div>
                        <div class="form-group m-form__group row" *ngIf="selectUsuario == 1">
                            <label class="col-lg-3 col-form-label">
                                Usuario*:
                            </label>
                            <div class="col-lg-9">
                                <div class="m-loader m-loader--primary m-loader--right" *ngIf="!usuarios">
                                    <input type="text" class="form-control"/>
                                </div>
                                <app-auto-complete *ngIf="usuarios" placeholder="Seleccione"
                                                    [ngModel]="usuarioRetirar" #usuario_retiro="ngModel"
                                                    name="usuario_retiro" required [items]="usuarios"
                                                    [textField]="'numero_identidad'"
                                                    textField1="nombre"
                                                    textField2="apellido"
                                                    valueField="numero_identidad" 
                                                    (change)="getDireccion(usuario_retiro.value)"
                                ></app-auto-complete>
                            </div>
                           
                        </div>
                        <div class="form-group m-form__group row" *ngIf="selectUsuario == 0">
                            <label class="col-lg-3 col-form-label">
                                Nombre*:
                            </label>
                            <div class="col-lg-3">
                                <input type="text" class="form-control m-input" placeholder="Nombre"
                                       [ngModel]="entrega.nombre" #nombre="ngModel" name="nombre" required>
                                <section *ngIf="nombre.invalid && nombre.dirty" class="bs">
                                    <p class="m--font-danger" *ngIf="nombre.hasError('required')">El nombre es
                                        requerido</p>
                                </section>
                            </div>
                            <label class="col-lg-3 col-form-label">
                                Apellidos:
                            </label>
                            <div class="col-lg-3">
                                <input type="text" class="form-control m-input" placeholder="Apellidos"
                                       [ngModel]="entrega.apellidos" #apellidos="ngModel"
                                       name="apellidos" required>
                                <section *ngIf="apellidos.invalid && apellidos.dirty" class="bs">
                                    <p class="m--font-danger" *ngIf="apellidos.hasError('required')">Los apellidos son
                                        requeridos</p>
                                </section>
                            </div>
                        </div>
                        <div class="form-group m-form__group row" *ngIf="(disabledDir && domicilio == 1) || (selectUsuario == 0)">
                            <label class="col-lg-3 col-form-label">
                                Cédula:
                            </label>
                            <div class="col-lg-3">
                                <input type="text" class="form-control m-input" placeholder="Cédula"
                                       [ngModel]="entrega.cedula" #cedula="ngModel" disabled={{disabledDir}}
                                       name="cedula" required>
                                <section *ngIf="cedula.invalid && cedula.dirty" class="bs">
                                <p class="m--font-danger" *ngIf="cedula.hasError('required')">La cédula es
                                    requerida</p>
                                </section>
                            </div>
                            <label class="col-lg-3 col-form-label">
                                Celular:
                            </label>
                            <div class="col-lg-3">
                                <input type="text" class="form-control m-input" placeholder="Celular"
                                       [ngModel]="entrega.celular" #celular="ngModel" disabled={{disabledDir}}
                                       name="celular" required>
                                <section *ngIf="celular.invalid && celular.dirty" class="bs">
                                <p class="m--font-danger" *ngIf="celular.hasError('required')">El celular es
                                    requerido</p>
                                </section>
                            </div>
                        </div>
                        <div class="form-group m-form__group row" *ngIf="(disabledDir && domicilio == 1) || (selectUsuario == 0 && domicilio == 1)">
                                <label class="col-lg-3 col-form-label">
                                    Dirección:
                                </label>
                                <div class="col-lg-9">
                                    <input type="text" class="form-control m-input" placeholder="Dirección"
                                    [ngModel]="entrega.direccion" #direccion="ngModel" disabled={{disabledDir}}
                                    name="direccion" required>
                                    <section *ngIf="direccion.invalid && direccion.dirty" class="bs">
                                    <p class="m--font-danger" *ngIf="direccion.hasError('required')">La dirección es
                                        requerida</p>
                                    </section>
                                </div>
                            
                        </div>
                        <div class="form-group m-form__group row" *ngIf="(disabledDir && domicilio == 1) || (selectUsuario == 0 && domicilio == 1)">
                            <label class="col-lg-3 col-form-label">
                                País:
                            </label>
                            <div class="col-lg-3">
                                <select  class="form-control m-input" placeholder="País" (change)="getProvincias(pais_id.value)"
                                        [(ngModel)]="entrega.ciudad.provincia.pais.id" #pais_id="ngModel" disabled={{disabledDir}} name="pais_id" required>
                                    <option [value]="" disabled>Seleccione un País</option>
                                    <option *ngFor="let pais of paisesEntrega" [value]="pais.id" >
                                        {{pais.nombre}}
                                    </option>
                                </select>
                            </div>
                            <label class="col-lg-3 col-form-label">
                                Provincia:
                            </label>
                            <div class="col-lg-3">
                                <app-auto-complete *ngIf="provincias" placeholder="Seleccione"
                                [(ngModel)]="entrega.ciudad.provincia.id" #provincia_id="ngModel"
                                name="provincia_id" required [items]="provincias"
                                (change)="getCiudades(provincia_id.value)"
                                [textField]="'nombre'" [disabled]="disabledDir"
                                valueField="id" 
                                 ></app-auto-complete>
                            </div>
                        </div>
                        <div class="form-group m-form__group row" *ngIf="(disabledDir && domicilio == 1) || (selectUsuario == 0 && domicilio == 1)">
                            <label class="col-lg-3 col-form-label">
                                Ciudad:
                            </label>
                            <div class="col-lg-3">
                                <app-auto-complete *ngIf="ciudades" placeholder="Seleccione"
                                [(ngModel)]="entrega.ciudad.id" #ciudad_id="ngModel"
                                name="ciudad_id" required [items]="ciudades"
                                [textField]="'nombre'" [disabled]="disabledDir"
                                valueField="id" 
                                 ></app-auto-complete>
                              
                            </div>
                            <label class="col-lg-3 col-form-label">
                                Parroquía:
                            </label>
                            <div class="col-lg-3">
                                <app-auto-complete *ngIf="parroquias" placeholder="Seleccione"
                                [ngModel]="entrega.parroquia.id" #parroquia_id="ngModel"
                                name="parroquia_id"  [items]="parroquias" [disabled]="disabledDir"
                                [textField]="'nombre'"
                                valueField="id"
                                 ></app-auto-complete>
                            
                            </div>
                            </div>
                            <div class="form-group m-form__group row"  *ngIf="(disabledDir && domicilio == 1) || (selectUsuario == 0 && domicilio == 1)">
                            <label class="col-lg-3 col-form-label">
                                Código Postal:
                            </label>
                            <div class="col-lg-3">
                                <input type="text" class="form-control m-input" placeholder="Código Postal"
                                [ngModel]="entrega.codigo_postal" #codigoPostal="ngModel" disabled={{disabledDir}}
                                name="codigoPostal" required>
                                <section *ngIf="codigoPostal.invalid && codigoPostal.dirty" class="bs">
                                <p class="m--font-danger" *ngIf="codigoPostal.hasError('required')">El código postal es
                                    requerido</p>
                                </section>
                            </div>
                        </div>
                        
                        <div class="form-group m-form__group row">
                            <label class="col-lg-3 col-form-label">
                                Anotación:
                            </label>
                            <div class="col-lg-9">
                                <input type="text" class="form-control m-input" placeholder="Anotación"
                                [ngModel]="entrega.nota" #nota="ngModel"
                                name="nota">
                            
                            </div>
                       
                    </div>
                    </div>
                    <input hidden type="text" class="form-control m-input"
                    [(ngModel)]="estatusSeleccion" #articulos="ngModel"
                    name="articulos">
                    <div class="m-portlet__foot m-portlet__no-border m-portlet__foot--fit">
                        <div class="m-form__actions m-form__actions--solid">
                            <div class="row">
                                <div class="col-lg-2"></div>
                                <div class="col-lg-10">
                                    <button type="submit"
                                            [disabled]="entregaForm.invalid && entrega.ciudad.id == '-1'"
                                            [class]="(entregaForm.invalid == false) ? 'btn btn-success' : 'btn btn-danger'"
                                    >
                                        Aceptar
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
                <div class="row" style="margin: 5px">
                    <h3>Artículos</h3>
                </div>
                <div class="table-responsive" style="overflow: auto;">
                <table class="table table-bordered table-responsive m-table m-table--head-bg-brand">
                    <thead>
                    <tr>
                        <th>
                            Img
                        </th> 
                        <th>
                            TRACKBOX
                        </th>
                        <th>
                            Track Remitente
                        </th>
                        <th>
                            Peso(Lb)
                            <div style="float: right;">
                                <input type="radio" class="radio-inline" id="Kg" name="tipopeso" value="1" [(ngModel)]="tpeso" #tipopeso="ngModel" required [checked]="tipopeso.value==1" (change)="onConversion(entrega.articulos)" > <label for="Kg" ><span></span>Kg</label>
                            
                                <input type="radio" class="radio-inline" id="lb" name="tipopeso" value="0"  [(ngModel)]="tpeso" #tipopeso="ngModel" required [checked]="tipopeso.value==0" (change)="onConversion(entrega.articulos)" > <label for="lb" ><span></span>Lb</label>      
                            </div>
                        </th>
                        <th>
                            Costo(USD)
                        </th>
                        <th>
                            Piezas
                        </th>
                        <th>
                            Dimensiones(In)
                        </th>
                        <th>Descripción </th>
                        <th>
                            Estado
                        </th> 
                        
                    </tr>
                    </thead>
                    <tbody>
                    <tr *ngFor="let articulo of entrega.articulos">
                        <td>
                            <img *ngIf="articulo.media && articulo.media[0]"
                                 style="width: 50px; height: 50px; object-fit: contain"
                                 [src]="articulo.media[0].web_url">
                        </td> 
                        <td>
                            <p *ngIf="articulo.trackbox">{{ articulo.trackbox }}</p>
                            <i class="fa fa-warning" *ngIf="!articulo.trackbox"></i>
                        </td>
                         <td>
                            {{ articulo.tracking }}
                        </td>
                        <td>
                            {{ articulo.peso | number:'1.2-2' }}
                        </td>
                       
                        <td>
                            {{ articulo.precio }}
                        </td>
                        <td>
                            {{ articulo.piezas }}
                        </td>
                        <td>
                            {{ articulo.largo }}x{{articulo.ancho}}x{{articulo.alto}}
                        </td>
                       <!--  <td>
                            <span class="m-list-settings__item-control">
                             <span class="m-badge m-badge--success m-badge--wide"
                                   *ngIf="articulo.factura == 1">Si</span>
                             <span class="m-badge m-badge--danger m-badge--wide" *ngIf="articulo.factura == 0">No</span>
                            </span>
                        </td> -->
                        <td>{{ articulo.descripcion }}</td>
                        <td>
                            {{ articulo.estado }}
                        </td> 
                        
                    </tr>
                    <tr style="font-weight: bold;">
                        <td colspan="3" style="text-align: center;">TOTAL</td>
                        <td>{{ totalPesoEnt | number:'1.2-2' }}</td>
                        <td>{{ totalPrecioEnt }}</td>
                        <td>{{ totalPiezas }}</td>
                        
                        <td colspan="3" ></td>
                    </tr>
                    </tbody>
                </table>
                </div>
            </div>

        </div>
    </div>
</ng-template>
<!--end::Modal-->